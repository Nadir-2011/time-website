<!DOCTYPE html>
<html>
  <head>
  <title>Time</title>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles/general.css">
  <link rel="stylesheet" href="time.css">
  </head>
  <body>
  <div class="pages-div">
  <p class="time-p">Time</p>
  <p class="alarm-p">Alarm</p>
  <p class="timer-p">Stopwatch</p>
  <p class="stopwatch-p">Timer</p>
  </div>

  <div class="time-div" id="timeDiv">
  <p class="realtime-p" id="clock">00:00:00</p>
  <p class="time-zone-p">Azerbaijan Time Zone</p>
  </div>
  
  <div id="addingAlarm">
  <div class="alarm-div" id="alarmDiv" style="display:none;">
  <p class="add-p">Add Alarm</p>
  <button class="add-button" id="addButton">+</button>
  </div>
  </div>

  <div class="makeing-alarm" style="display:none;" id="makeingAlarm">
  <p class="alarm-time-p">Alarm Time</p>
  <input type="number" class="hour-input">
  <p class="l-dont-know-p">:</p>
  <input type="number" class="minute-input">
  <button class="second-add-button">Add</button>
  </div>

  <div class="timer-div" id="timerDiv" style="display:none;">
  <p class="timer-second-p">00</p>
  <p class="timer-second-p">:</p>
  <p class="timer-second-p">00</p>
  <p class="timer-second-p">:</p>
  <p class="timer-second-p" id="secondTime">00</p>

  <button class="reset-button" onclick="resetTimer()">Reset</button>
  <button class="stop-button" onclick="stopTimer()">Stop</button>
  <button class="start-button" onclick="startTimer()">Start</button>
  </div>
  
  <div class="stopwatch-div" id="stopwatchDiv" style="display:none;">
  <input type="number" class="stopwatch-input" id="stopwatchInput">
  <button class="stopwatch-start-button" onclick="startStopwatch()">Start</button>
</div>
  <script>
    function updateClock() {
       const now = new Date();


    let hours = now.getHours();
    let minutes = now.getMinutes();
    let seconds = now.getSeconds();

    hours = hours < 10 ? "0" + hours : hours;
    minutes = minutes < 10 ? "0" + minutes : minutes;
    seconds = seconds < 10 ? "0" + seconds : seconds;

     const timeString = `${hours}:${minutes}:${seconds}`;
      document.getElementById("clock").textContent = timeString;
    };
       setInterval(updateClock, 1000);
    updateClock();

    const timeDiv = document.getElementById('timeDiv');
const alarmDiv = document.getElementById('alarmDiv');

document.querySelector('.alarm-p').addEventListener('click', function () {
  timeDiv.style.display = 'none';
  alarmDiv.style.display = 'block';
});

      const pages = document.querySelectorAll('.pages-div p');
      const allDivs = {
        'time-p': document.getElementById('timeDiv'),
        'alarm-p': document.getElementById('alarmDiv'),
        'timer-p': document.getElementById('timerDiv'),
        'stopwatch-p': document.getElementById('stopwatchDiv'),
         'makeingAlarm' : document.getElementById('makeingAlarm')
      };

      pages.forEach(page => {
        page.addEventListener('click', function () {
          pages.forEach(p => p.classList.remove('active'));
          page.classList.add('active');

          for (let key in allDivs) {
            if (allDivs[key]) {
              allDivs[key].style.display = 'none';
            }
          }

          const className = page.classList[0];
          const selectedDiv = allDivs[className];
          if (selectedDiv) {
            selectedDiv.style.display = 'block';
          }
        });
      });


      const addButton = document.getElementById('addButton');
      const addingAlarm = document.getElementById('addingAlarm');
      const makeingAlarm = document.getElementById('makeingAlarm');

      addButton.addEventListener('click' , function() {
        addingAlarm.style.display = "none";
        makeingAlarm.style.display = "inline-block";
      });

      
  const secondAddButton = document.querySelector('.second-add-button');
  secondAddButton.addEventListener('click', function () {
    const hour = document.querySelector('.hour-input').value;
    const minute = document.querySelector('.minute-input').value;

    if (hour === "" || minute === "") {
      alert("Please Write a Hour and Minute!");
      return;
    }

    alarmHour = hour.padStart(2, '0');
    alarmMinute = minute.padStart(2, '0');
    alert(`Alarm preaped: ${alarmHour}:${alarmMinute}`);
  });

let secondSecond = 0;
let minuteSecond = 0;
let hoursSecond = 0;
let intervalId;

function startTimer() {
  if (!intervalId) {
    intervalId = setInterval(() => {
      secondSecond++;
      if (secondSecond === 60) {
        secondSecond = 0;
        minuteSecond++;
      }
      if (minuteSecond === 60) {
        minuteSecond = 0;
        hoursSecond++;
      }
      document.getElementById('secondTime').innerText = secondSecond.toString().padStart(2, '0');
    }, 1000);
  }
}

function stopTimer() {
  clearInterval(intervalId);
  intervalId = null;
}

function resetTimer() {

  stopTimer();
  secondSecond = 0;
  minuteSecond = 0;
  hoursSecond = 0;
  document.getElementById('secondTime').innerText = "00";
};
  
function startStopwatch(){
  let stopwatchInputValue = parseInt(document.getElementById('stopwatchInput').value, 10);

  if (isNaN(stopwatchInputValue) || stopwatchInputValue < 1) {
    alert('Please write a number of seconds');
    return;
  }

  let countdown = setInterval(() => {
    stopwatchInputValue--;

    document.getElementById('stopwatchInput').value = stopwatchInputValue;

    if (stopwatchInputValue <= 0) {
      clearInterval(countdown);
      alert("Stopwatch finished!");
    }
  }, 1000);
}

let alarmHour = null;
let alarmMinute = null;
let alarmTriggered = false;

function checkAlarm() {
  if (alarmHour === null || alarmMinute === null) return;

  const now = new Date();
  let h = now.getHours();
  let m = now.getMinutes();

  let hStr = h.toString().padStart(2, '0');
  let mStr = m.toString().padStart(2, '0');

  if (alarmTriggered) return; 

  if (hStr === alarmHour && mStr === alarmMinute) {
    alert(`Alarm Time! Time: ${alarmHour}:${alarmMinute}`);
    alarmTriggered = true;
  }
}

setInterval(checkAlarm, 1000);

  </script>
  </body>
</html>